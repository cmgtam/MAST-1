<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The Recipe &mdash; MAST 20131216.canoe documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '20131216.canoe',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="MAST 20131216.canoe documentation" href="index.html" />
    <link rel="next" title="Running MAST" href="5_0_runningmast.html" />
    <link rel="prev" title="Input File" href="3_0_inputfile.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="5_0_runningmast.html" title="Running MAST"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="3_0_inputfile.html" title="Input File"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">MAST 20131216.canoe documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="the-recipe">
<h1>The Recipe<a class="headerlink" href="#the-recipe" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction-to-the-recipe">
<h2>Introduction to the Recipe<a class="headerlink" href="#introduction-to-the-recipe" title="Permalink to this headline">¶</a></h2>
<p>The recipe defines the relationships between ingredients, or which ingredients need to be run before which other ingredients.</p>
<p>Out-of-the-box recipes are stored in <tt class="docutils literal"><span class="pre">$MAST_INSTALL_PATH/recipe_templates</span></tt>. You may copy them into your <tt class="docutils literal"><span class="pre">$MAST_RECIPE_PATH</span></tt> directory (see <a class="reference internal" href="1_0_installation.html"><em>Installation</em></a>). If you create new recipes, they should also go in the  <tt class="docutils literal"><span class="pre">$MAST_RECIPE_PATH</span></tt> directory</p>
<p>The full recipe name goes in the <tt class="docutils literal"><span class="pre">$recipe</span></tt> section of the input file:</p>
<div class="highlight-python"><pre>$recipe
recipe_file neb.txt</pre>
</div>
<p>$end</p>
<p><strong>Important: when creating or editing recipes, do not use the Tab key. Instead, use 4 spaces to indent.</strong></p>
<p>Also make sure that the recipe you are working with has not somehow been converted to tabs.</p>
<p>If you use vi as your code editor, consider adding the following settings to your <tt class="docutils literal"><span class="pre">~/.vimrc</span> <span class="pre">file</span></tt>, in order to use python four-space tab stops instead of the Tab character.:</p>
<div class="highlight-python"><pre>set tabstop=4
set shiftwidth=4
set smarttab
set expandtab
set softtabstop=4
set autoindent</pre>
</div>
<div class="section" id="syntax">
<h3>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h3>
<p>Each indentation level marks a parent-child relationship.</p>
<dl class="docutils">
<dt>perfect_opt1 (volrelax_lowmesh)</dt>
<dd><dl class="first last docutils">
<dt>perfect_opt2</dt>
<dd>perfect_opt3</dd>
</dl>
</dd>
</dl>
<p>The ingredient type of an ingredient is specified in parentheses after the ingredient.</p>
<p>The ingredient type should correspond to ingredient subsections within the $ingredients section of the <a class="reference internal" href="3_0_inputfile.html"><em>input file</em></a>. If no ingredient type is specified, the ingredient gets all default values from the ingredients_global subsection.</p>
<p>In the recipe:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">perfect_opt1</span> <span class="p">(</span><span class="n">volrelax_lowmesh</span><span class="p">)</span>
</pre></div>
</div>
<p>In the input file:</p>
<p>$ingredients</p>
<blockquote>
<div><p>begin volrelax_lowmesh
mast_run_method run_singlerun
...
end</p>
<p>$end</p>
</div></blockquote>
<p>If the parent needs to update several children in different ways, create new trees where the originating parent is the same parent name, but with a different ingredient type.
*  Those different ingredient types should have different mast_update_children_method keyword values in the input file.
*  Only the first ingredient type specified per parent, going from the top of the file to the bottom of the file, will be used for all program keywords (run method, write method, INCAR settings, etc.) except for mast_update_children_method. The mast_update_children_method will be taken from the ingredient type specified between the parent and that child.</p>
<div class="highlight-python"><pre>perfect_stat (stat_to_defect)
    defect_opt
perfect_stat (stat_to_phonon)
    phonon_opt1</pre>
</div>
<p>If two children need to be the parent of one ingredient, also create a new tree:</p>
<div class="highlight-python"><pre>perfect_stat
    defect_1_opt
    defect_2_opt
defect_1_opt, defect_2_opt
    neb_1-2_opt</pre>
</div>
<p>Parent-child relationships are name-based, and the name must also include correct formats for defect labels (defect_XXX), charge labels (q=XX), neb labels (neb_XXX-XXX), and phonon labels (phonon_XXX). These names are important for following the tree structure and for setting the metadata file. Parent-child relationships are specified by these particular folder names. However, once all runs have been completed, post-processing utilities should only look at the metadata file within each run folder, and not at the folder name.</p>
<p>For defects, the labels must correspond to labels in the <tt class="docutils literal"><span class="pre">$defects</span></tt> section:</p>
<div class="highlight-python"><pre>defect_&lt;label&gt;</pre>
</div>
<p>Defect charges are given as q=p0 for no charge, q=nX for negative charge X (remember that negative charge means more electrons), and q=pX for positive charge X.
(Please note that inducedefect ingredients should be labeled with inducedefect rather than with induce_defect, which will confuse them with defect ingredient labels.)</p>
<p>For nebs, the labels must correspond to labels in the <tt class="docutils literal"><span class="pre">$neb</span></tt> section:</p>
<div class="highlight-python"><pre>neb_&lt;label&gt;</pre>
</div>
<p>For phonons, the labels must correspond to labels in the <tt class="docutils literal"><span class="pre">$phonon</span></tt> section:</p>
<div class="highlight-python"><pre>phonon_&lt;label&gt;
phonon_&lt;label&gt;_parse</pre>
</div>
<p>You may create a fully-specified recipe in which you write out the labels, and also the charges, if necessary, for example:</p>
<p>defect_opt1_q=n2 (lowmesh)</p>
<p>However, in many cases it is more convenient to use abbreviations within the recipe.
<tt class="docutils literal"><span class="pre">{begin}</span></tt> and <tt class="docutils literal"><span class="pre">{end}</span></tt> tags specify sections that can be looped over for as many defect labels <tt class="docutils literal"><span class="pre">&lt;N&gt;</span></tt> are specified in the <tt class="docutils literal"><span class="pre">$defects</span></tt> section of the input file and NEB labels <tt class="docutils literal"><span class="pre">&lt;B-E&gt;</span></tt>, where <tt class="docutils literal"><span class="pre">&lt;B&gt;</span></tt> and <tt class="docutils literal"><span class="pre">&lt;E&gt;</span></tt> are also defect labels, as specified in the <tt class="docutils literal"><span class="pre">$neb</span></tt> section of the input file.</p>
<p>Charges <tt class="docutils literal"><span class="pre">&lt;Q&gt;</span></tt> are given by the charge range in the <tt class="docutils literal"><span class="pre">$defects</span></tt> section. Available charges are carried into the <tt class="docutils literal"><span class="pre">&lt;B-E&gt;_&lt;Q&gt;</span></tt> labels based on which charges are available to both the <tt class="docutils literal"><span class="pre">&lt;B&gt;</span></tt> and the <tt class="docutils literal"><span class="pre">&lt;E&gt;</span></tt> defect in the label.</p>
<p>Note that defect endpoints need to be the parents of all NEB optimizations and NEB static calculations.</p>
<p>Example:</p>
<div class="highlight-python"><pre>Recipe NEBtest
perfect_opt1 (lowmesh)
    perfect_opt2
        perfect_stat (static)
        {begin}
        inducedefect_&lt;N&gt; (inducedefect)
            defect_&lt;N&gt;_&lt;Q&gt;_opt1 (lowmesh_defect)
                defect_&lt;N&gt;_&lt;Q&gt;_opt2 (defect_relax)
                    defect_&lt;N&gt;_&lt;Q&gt;_stat (static)
        {end}
{begin}
defect_&lt;N&gt;_&lt;Q&gt;_stat (static)
    phonon_&lt;N&gt;_&lt;Q&gt;_&lt;P&gt; (phonon)
        phonon_&lt;N&gt;_&lt;Q&gt;_&lt;P&gt;_parse (phononparse)
{end}
{begin}
defect_&lt;B&gt;_&lt;Q&gt;_stat (static_to_neb), defect_&lt;E&gt;_&lt;Q&gt;_stat (static_to_neb)
    neb_&lt;B-E&gt;_&lt;Q&gt;_opt1 (neb_to_neb)
        neb_&lt;B-E&gt;_&lt;Q&gt;_opt2 (neb_to_nebstat)
            neb_&lt;B-E&gt;_&lt;Q&gt;_stat (nebstat_to_phonon)
    neb_&lt;B-E&gt;_&lt;Q&gt;_opt2 (neb_to_nebstat)
    neb_&lt;B-E&gt;_&lt;Q&gt;_stat (nebstat_to_phonon)
{end}
{begin}
neb_&lt;B-E&gt;_&lt;Q&gt;_stat (nebstat_to_phonon)
    phonon_&lt;B-E&gt;_&lt;Q&gt;_&lt;P&gt; (phonon)
        phonon_&lt;B-E&gt;_&lt;Q&gt;_&lt;P&gt;_parse (phononparse)
{end}</pre>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/MAST_logo_200px.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">The Recipe</a><ul>
<li><a class="reference internal" href="#introduction-to-the-recipe">Introduction to the Recipe</a><ul>
<li><a class="reference internal" href="#syntax">Syntax</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="3_0_inputfile.html"
                        title="previous chapter">Input File</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="5_0_runningmast.html"
                        title="next chapter">Running MAST</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="5_0_runningmast.html" title="Running MAST"
             >next</a> |</li>
        <li class="right" >
          <a href="3_0_inputfile.html" title="Input File"
             >previous</a> |</li>
        <li><a href="index.html">MAST 20131216.canoe documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, CMG.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>